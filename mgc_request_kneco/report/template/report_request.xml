<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <!--Request Slip Template-->
        <template id="report_request">
			<t t-call="report.html_container">
				<t t-call="report.external_layout"/>
				<t t-foreach="docs" t-as="o">
					<t t-set="o" t-value="o.with_context({'lang':o.company_id.partner_id.lang})"/>
                        <div class="page">
                            <div class="col-xs-4 pull-right mt8" name="right_box" style="text-align:center;">
                                <span><img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' % ('Code128', o.request_number, 600, 600)" style="width:400px;height:50px;align:left;"/></span>
                            </div>
                            <t t-if="o.state=='draft' or o.state=='print_rf'">
                                <div style="position:absolute;opacity:0.25;z-index:1000;transform:rotate(315deg);-webkit-transform:rotate(315deg);width:150%;">
                                    <h2 style="font-size:50px;font-weight:bold;"><strong>REQUEST NOT CONFIRMED</strong></h2>
                                </div>
                                <br/>
                                <strong><h3>REQUEST #: <span t-field="o.request_number"/></h3></strong>
                            </t>
                            <t t-if="o.state=='cancelled'">
                                <div style="position:absolute;opacity:0.25;z-index:1000;transform:rotate(315deg);-webkit-transform:rotate(315deg);width:150%;">
                                    <h2 style="font-size:50px;font-weight:bold;"><strong>CANCELLED</strong></h2>
                                </div>
                            </t>
                            <t t-if="o.state=='confirmed' or o.state=='done'">
                                <br/>
                                <strong><h3>REQUEST CONFIRMATION #: <span t-field="o.request_number"/></h3></strong>
                            </t>
                            <t style="text-align:left;font-size:12px" t-if="o.date_request">
                                <h4><span>DATE REQUESTED: </span><b><t t-esc="time.strftime('%B %d, %Y', time.strptime(o.date_request,'%Y-%m-%d'))"/></b></h4>
                            </t>
                            <div class="row mt32 mb32">
                                <div>
                                   <strong><h4><i>REQUESTOR</i></h4></strong>
                                </div>
                                <div class="col-xs-3" t-if="o.company_id">
                                    <strong>COMPANY</strong>
                                    <p class="text-uppercase" t-field="o.company_id.name"/>
                                </div>
                                <div class="col-xs-3" t-if="o.department_id">
                                    <strong>BRANCH / DEPARTMENT</strong>
                                    <p class="text-uppercase" t-field="o.department_id.name"/>
                                </div>
                                <div class="col-xs-3" t-if="o.employee_id">
                                    <strong>REQUESTOR'S NAME</strong>
                                    <p class="text-uppercase" t-field="o.employee_id.name"/>
                                </div>
                            </div>
                            <div class="row mt32 mb32">
                                <div>
                                    <strong><h4><i>REQUEST THROUGH</i></h4></strong>
                                </div>
                                <div class="col-xs-3" t-if="o.request_selection =='contacts' and o.partner_id">
                                    <strong>CONTACTS</strong>
                                    <p t-field="o.partner_id.name"/>
                                </div>
                                <div class="col-xs-3" t-if="o.request_selection =='company' and o.request_company_id">
                                    <strong>COMPANY</strong>
                                    <p t-field="o.request_company_id.name"/>
                                </div>
                                <div class="col-xs-3" t-if="o.request_selection =='company' and o.request_department_id">
                                    <strong>BRANCH / DEPARTMENT</strong>
                                    <p t-field="o.request_department_id.name"/>
                                </div>
                                <div class="col-xs-3" t-if="o.request_type_id">
                                    <strong>REQUEST TYPE</strong><br/>
                                    <span class="text-uppercase"><span t-field="o.request_type_id.name"/> / <span t-field="o.request_type_line_id.name"/></span>

                                </div>
                            </div>
                            <div class="row mt32 mb32">
                                <div class="col-xs-4" t-if="o.purpose">
                                    <strong>PURPOSE</strong>
                                    <p t-field="o.purpose"/>
                                </div>
                                <div class="col-xs-4" t-if="o.notes">
                                    <strong>SPECIAL INSTRUCTION</strong>
                                    <p t-field="o.notes"/>
                                </div>
                            </div>
                            <table class="table table-condensed">
                                <thead>
                                    <tr>
                                        <th><strong>Description</strong></th>
                                        <th><strong>Taxes</strong></th>
                                        <th class="text-center"><strong>Date Req</strong></th>
                                        <th class="text-right"><strong>Qty</strong></th>
                                        <th class="text-right"><strong>Unit Price</strong></th>
                                        <th class="text-right"><strong>Net Price</strong></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr t-foreach="o.request_line" t-as="line">
                                        <td>
                                            <span t-field="line.description"/>
                                        </td>
                                        <td>
                                            <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-field="line.date_scheduled"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="line.quantity"/>
                                            <span t-field="line.unit_uom.name"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="line.price_unit"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="line.price_subtotal"
                                                t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="row">
                                <div class="col-xs-4 pull-right">
                                    <table class="table table-condensed">
                                        <tr class="border-black">
                                            <td><strong>Total Without Taxes</strong></td>
                                            <td class="text-right">
                                                <span t-field="o.amount_untaxed"
                                                    t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Taxes</td>
                                            <td class="text-right">
                                                <span t-field="o.amount_tax"
                                                    t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                            </td>
                                        </tr>
                                        <tr class="border-black">
                                            <td><strong>Total</strong></td>
                                            <td class="text-right">
                                                <h4><strong><span t-field="o.amount_total"
                                                    t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></strong></h4>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div><br/>
                        </div>
                </t>
            </t>
        </template>


        <template id="report_request_footer" inherit_id="report_request">
            <xpath expr="//t[@t-call='report.external_layout']" position="attributes">
                <attribute name="t-call">mgc_request.external_layout_footer_custom_request</attribute>
            </xpath>
        </template>

    </data>
</odoo>